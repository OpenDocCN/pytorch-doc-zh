# 振荡器和ADSR包络

> 原文：[https://pytorch.org/audio/stable/tutorials/oscillator_tutorial.html](https://pytorch.org/audio/stable/tutorials/oscillator_tutorial.html)

注意

点击[这里](#sphx-glr-download-tutorials-oscillator-tutorial-py)下载完整示例代码

**作者**：[Moto Hira](mailto:moto%40meta.com)

本教程展示了如何使用 [`oscillator_bank()`](../generated/torchaudio.prototype.functional.oscillator_bank.html#torchaudio.prototype.functional.oscillator_bank) 和 [`adsr_envelope()`](../generated/torchaudio.prototype.functional.adsr_envelope.html#torchaudio.prototype.functional.adsr_envelope) 合成各种波形。

警告

本教程需要原型DSP功能，这些功能在夜间构建中可用。

请参考 [https://pytorch.org/get-started/locally](https://pytorch.org/get-started/locally) 以获取安装夜间构建的说明。

```py
import torch
import torchaudio

print(torch.__version__)
print([torchaudio.__version__](https://docs.python.org/3/library/stdtypes.html#str "builtins.str")) 
```

```py
2.2.0
2.2.0 
```

```py
try:
    from torchaudio.prototype.functional import adsr_envelope, oscillator_bank
except ModuleNotFoundError:
    print(
        "Failed to import prototype DSP features. "
        "Please install torchaudio nightly builds. "
        "Please refer to https://pytorch.org/get-started/locally "
        "for instructions to install a nightly build."
    )
    raise

import math

import matplotlib.pyplot as plt
from IPython.display import Audio

[PI](https://docs.python.org/3/library/functions.html#float "builtins.float") = [torch.pi](https://docs.python.org/3/library/functions.html#float "builtins.float")
[PI2](https://docs.python.org/3/library/functions.html#float "builtins.float") = 2 * [torch.pi](https://docs.python.org/3/library/functions.html#float "builtins.float") 
```

## 振荡器银行

正弦振荡器从给定的振幅和频率生成正弦波形。

\[x_t = A_t \sin \theta_t\]

其中相位 \(\theta_t\) 是通过积分瞬时频率 \(f_t\) 找到的。

\[\theta_t = \sum_{k=1}^{t} f_k\]

注意

为什么要积分频率？瞬时频率表示给定时间的振荡速度。因此，积分瞬时频率给出了振荡相位的位移，自起始以来。在离散时间信号处理中，积分变为累积。在PyTorch中，可以使用 [`torch.cumsum()`](https://pytorch.org/docs/stable/generated/torch.cumsum.html#torch.cumsum) 计算累积。

[`torchaudio.prototype.functional.oscillator_bank()`](../generated/torchaudio.prototype.functional.oscillator_bank.html#torchaudio.prototype.functional.oscillator_bank) 从振幅包络和瞬时频率生成一组正弦波形。

### 简单正弦波

让我们从简单的情况开始。

首先，我们生成具有恒定频率和振幅的正弦波，即常规正弦波。

我们定义一些常量和帮助函数，这些将在本教程的其余部分中使用。

```py
[F0](https://docs.python.org/3/library/functions.html#float "builtins.float") = 344.0  # fundamental frequency
[DURATION](https://docs.python.org/3/library/functions.html#float "builtins.float") = 1.1  # [seconds]
[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int") = 16_000  # [Hz]

[NUM_FRAMES](https://docs.python.org/3/library/functions.html#int "builtins.int") = int([DURATION](https://docs.python.org/3/library/functions.html#float "builtins.float") * [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int")) 
```

```py
def show([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), sample_rate, zoom=None, vol=0.3):
    t = ([torch.arange](https://pytorch.org/docs/stable/generated/torch.arange.html#torch.arange "torch.arange")([waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor").size(0)) / sample_rate).numpy()

    fig, axes = plt.subplots(4, 1, sharex=True)
    axes[0].plot(t, [freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor").numpy())
    axes[0].set(title=f"Oscillator bank (bank size: {[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor").size(-1)})", ylabel="Frequency [Hz]", ylim=[-0.03, None])
    axes[1].plot(t, [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor").numpy())
    axes[1].set(ylabel="Amplitude", ylim=[-0.03 if [torch.all](https://pytorch.org/docs/stable/generated/torch.all.html#torch.all "torch.all")([amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") >= 0.0) else None, None])
    axes[2].plot(t, [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor").numpy())
    axes[2].set(ylabel="Waveform")
    axes[3].specgram([waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), Fs=sample_rate)
    axes[3].set(ylabel="Spectrogram", xlabel="Time [s]", xlim=[-0.01, t[-1] + 0.01])

    for i in range(4):
        axes[i].grid(True)
    pos = axes[2].get_position()
    plt.tight_layout()

    if zoom is not None:
        ax = fig.add_axes([pos.x0 + 0.01, pos.y0 + 0.03, pos.width / 2.5, pos.height / 2.0])
        ax.plot(t, [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"))
        ax.set(xlim=zoom, xticks=[], yticks=[])

    [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") /= [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor").abs().max()
    return Audio(vol * [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), rate=sample_rate, normalize=False) 
```

现在我们合成具有恒定频率和振幅的音频

```py
[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [torch.full](https://pytorch.org/docs/stable/generated/torch.full.html#torch.full "torch.full")(([NUM_FRAMES](https://docs.python.org/3/library/functions.html#int "builtins.int"), 1), [F0](https://docs.python.org/3/library/functions.html#float "builtins.float"))
[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [torch.ones](https://pytorch.org/docs/stable/generated/torch.ones.html#torch.ones "torch.ones")(([NUM_FRAMES](https://docs.python.org/3/library/functions.html#int "builtins.int"), 1))

[waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = oscillator_bank([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), sample_rate=[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"))

show([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"), zoom=(1 / [F0](https://docs.python.org/3/library/functions.html#float "builtins.float"), 3 / [F0](https://docs.python.org/3/library/functions.html#float "builtins.float"))) 
```

![振荡器银行（银行大小：1）](../Images/85cdb13ee98cbd3eb3cd714f3fbdc73b.png)

您的浏览器不支持音频元素。

### 组合多个正弦波

[`oscillator_bank()`](../generated/torchaudio.prototype.functional.oscillator_bank.html#torchaudio.prototype.functional.oscillator_bank) 可以组合任意数量的正弦波来生成波形。

```py
[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [torch.empty](https://pytorch.org/docs/stable/generated/torch.empty.html#torch.empty "torch.empty")(([NUM_FRAMES](https://docs.python.org/3/library/functions.html#int "builtins.int"), 3))
[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor")[:, 0] = [F0](https://docs.python.org/3/library/functions.html#float "builtins.float")
[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor")[:, 1] = 3 * [F0](https://docs.python.org/3/library/functions.html#float "builtins.float")
[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor")[:, 2] = 5 * [F0](https://docs.python.org/3/library/functions.html#float "builtins.float")

[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [torch.ones](https://pytorch.org/docs/stable/generated/torch.ones.html#torch.ones "torch.ones")(([NUM_FRAMES](https://docs.python.org/3/library/functions.html#int "builtins.int"), 3)) / 3

[waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = oscillator_bank([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), sample_rate=[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"))

show([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"), zoom=(1 / [F0](https://docs.python.org/3/library/functions.html#float "builtins.float"), 3 / [F0](https://docs.python.org/3/library/functions.html#float "builtins.float"))) 
```

![振荡器银行（银行大小：3）](../Images/cb9d8b5d8ac2ebcad500082adba8683c.png)

您的浏览器不支持音频元素。

### 随时间变化的频率

让我们随时间改变频率。在这里，我们以对数尺度将频率从零变化到奈奎斯特频率（采样率的一半），以便更容易看到波形的变化。

```py
[nyquist_freq](https://docs.python.org/3/library/functions.html#float "builtins.float") = [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int") / 2
[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [torch.logspace](https://pytorch.org/docs/stable/generated/torch.logspace.html#torch.logspace "torch.logspace")(0, [math.log](https://docs.python.org/3/library/math.html#math.log "math.log")(0.99 * [nyquist_freq](https://docs.python.org/3/library/functions.html#float "builtins.float"), 10), [NUM_FRAMES](https://docs.python.org/3/library/functions.html#int "builtins.int")).unsqueeze(-1)
[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [torch.ones](https://pytorch.org/docs/stable/generated/torch.ones.html#torch.ones "torch.ones")(([NUM_FRAMES](https://docs.python.org/3/library/functions.html#int "builtins.int"), 1))

[waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = oscillator_bank([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), sample_rate=[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"))

show([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"), vol=0.2) 
```

![振荡器银行（银行大小：1）](../Images/7533eae9ba1a1de4063506e20c82e055.png)

您的浏览器不支持音频元素。

我们也可以振荡频率。

```py
[fm](https://docs.python.org/3/library/functions.html#float "builtins.float") = 2.5  # rate at which the frequency oscillates
[f_dev](https://docs.python.org/3/library/functions.html#float "builtins.float") = 0.9 * [F0](https://docs.python.org/3/library/functions.html#float "builtins.float")  # the degree of frequency oscillation

[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [F0](https://docs.python.org/3/library/functions.html#float "builtins.float") + [f_dev](https://docs.python.org/3/library/functions.html#float "builtins.float") * [torch.sin](https://pytorch.org/docs/stable/generated/torch.sin.html#torch.sin "torch.sin")([torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace "torch.linspace")(0, [fm](https://docs.python.org/3/library/functions.html#float "builtins.float") * [PI2](https://docs.python.org/3/library/functions.html#float "builtins.float") * [DURATION](https://docs.python.org/3/library/functions.html#float "builtins.float"), [NUM_FRAMES](https://docs.python.org/3/library/functions.html#int "builtins.int")))
[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor").unsqueeze(-1)

[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [torch.ones](https://pytorch.org/docs/stable/generated/torch.ones.html#torch.ones "torch.ones")(([NUM_FRAMES](https://docs.python.org/3/library/functions.html#int "builtins.int"), 1))

[waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = oscillator_bank([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), sample_rate=[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"))

show([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int")) 
```

![振荡器银行（银行大小：1）](../Images/547b774a06d14d1224331f668583ea51.png)

您的浏览器不支持音频元素。

## ADSR包络

接下来，我们随时间改变振幅。建模振幅的常见技术是ADSR包络。

ADSR代表攻击、衰减、维持和释放。

> +   攻击是从零到最高水平所需的时间。
> +   
> +   衰减是从顶部到达维持水平所需的时间。
> +   
> +   维持是级别保持恒定的水平。
> +   
> +   释放是从维持水平下降到零所需的时间。

ADSR模型有许多变体，此外，一些模型具有以下特性

> +   保持：攻击后级别保持在顶级的时间。
> +   
> +   非线性衰减/释放：衰减和释放发生非线性变化。

[`adsr_envelope`](../generated/torchaudio.prototype.functional.adsr_envelope.html#torchaudio.prototype.functional.adsr_envelope "torchaudio.prototype.functional.adsr_envelope")支持保持和多项式衰减。

```py
[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [torch.full](https://pytorch.org/docs/stable/generated/torch.full.html#torch.full "torch.full")(([SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"), 1), [F0](https://docs.python.org/3/library/functions.html#float "builtins.float"))
[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = adsr_envelope(
    [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"),
    attack=0.2,
    hold=0.2,
    decay=0.2,
    sustain=0.5,
    release=0.2,
    n_decay=1,
)
[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor").unsqueeze(-1)

[waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = oscillator_bank([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), sample_rate=[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"))

audio = show([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"))
ax = plt.gcf().axes[1]
ax.annotate("Attack", xy=(0.05, 0.7))
ax.annotate("Hold", xy=(0.28, 0.65))
ax.annotate("Decay", xy=(0.45, 0.5))
ax.annotate("Sustain", xy=(0.65, 0.3))
ax.annotate("Release", xy=(0.88, 0.35))
audio 
```

振荡器组（组大小：1）

您的浏览器不支持音频元素。

现在让我们看一些ADSR包络如何用于创建不同的声音的示例。

以下示例受[此文章](https://www.edmprod.com/adsr-envelopes/)启发。

### 鼓点

```py
[unit](https://docs.python.org/3/library/functions.html#int "builtins.int") = [NUM_FRAMES](https://docs.python.org/3/library/functions.html#int "builtins.int") // 3
[repeat](https://docs.python.org/3/library/functions.html#int "builtins.int") = 9

[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [torch.empty](https://pytorch.org/docs/stable/generated/torch.empty.html#torch.empty "torch.empty")(([unit](https://docs.python.org/3/library/functions.html#int "builtins.int") * [repeat](https://docs.python.org/3/library/functions.html#int "builtins.int"), 2))
[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor")[:, 0] = [F0](https://docs.python.org/3/library/functions.html#float "builtins.float") / 9
[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor")[:, 1] = [F0](https://docs.python.org/3/library/functions.html#float "builtins.float") / 5

[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [torch.stack](https://pytorch.org/docs/stable/generated/torch.stack.html#torch.stack "torch.stack")(
    (
        adsr_envelope([unit](https://docs.python.org/3/library/functions.html#int "builtins.int"), attack=0.01, hold=0.125, decay=0.12, sustain=0.05, release=0),
        adsr_envelope([unit](https://docs.python.org/3/library/functions.html#int "builtins.int"), attack=0.01, hold=0.25, decay=0.08, sustain=0, release=0),
    ),
    dim=-1,
)
[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor").[repeat](https://docs.python.org/3/library/functions.html#int "builtins.int")([repeat](https://docs.python.org/3/library/functions.html#int "builtins.int"), 1) / 2

[bass](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = oscillator_bank([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), sample_rate=[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"))

show([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [bass](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"), vol=0.5) 
```

振荡器组（组大小：2）

您的浏览器不支持音频元素。

### 拨弦

```py
[tones](https://docs.python.org/3/library/stdtypes.html#list "builtins.list") = [
    513.74,  # do
    576.65,  # re
    647.27,  # mi
    685.76,  # fa
    769.74,  # so
    685.76,  # fa
    647.27,  # mi
    576.65,  # re
    513.74,  # do
]

[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [torch.cat](https://pytorch.org/docs/stable/generated/torch.cat.html#torch.cat "torch.cat")([[torch.full](https://pytorch.org/docs/stable/generated/torch.full.html#torch.full "torch.full")(([unit](https://docs.python.org/3/library/functions.html#int "builtins.int"), 1), tone) for tone in [tones](https://docs.python.org/3/library/stdtypes.html#list "builtins.list")], dim=0)
[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = adsr_envelope([unit](https://docs.python.org/3/library/functions.html#int "builtins.int"), attack=0, decay=0.7, sustain=0.28, release=0.29)
[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor").[repeat](https://docs.python.org/3/library/functions.html#int "builtins.int")(9).unsqueeze(-1)

[doremi](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = oscillator_bank([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), sample_rate=[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"))

show([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [doremi](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int")) 
```

振荡器组（组大小：1）

您的浏览器不支持音频元素。

### 上升者

```py
[env](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = adsr_envelope([NUM_FRAMES](https://docs.python.org/3/library/functions.html#int "builtins.int") * 6, attack=0.98, decay=0.0, sustain=1, release=0.02)

[tones](https://docs.python.org/3/library/stdtypes.html#list "builtins.list") = [
    484.90,  # B4
    513.74,  # C5
    576.65,  # D5
    1221.88,  # D#6/Eb6
    3661.50,  # A#7/Bb7
    6157.89,  # G8
]
[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [torch.stack](https://pytorch.org/docs/stable/generated/torch.stack.html#torch.stack "torch.stack")([f * [env](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") for f in [tones](https://docs.python.org/3/library/stdtypes.html#list "builtins.list")], dim=-1)

[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [env](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor").unsqueeze(-1).expand([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor").shape) / len([tones](https://docs.python.org/3/library/stdtypes.html#list "builtins.list"))

[waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = oscillator_bank([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), sample_rate=[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"))

show([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int")) 
```

振荡器组（组大小：6）

您的浏览器不支持音频元素。

## 参考资料

+   [https://www.edmprod.com/adsr-envelopes/](https://www.edmprod.com/adsr-envelopes/)

+   [https://pages.mtu.edu/~suits/notefreq432.html](https://pages.mtu.edu/~suits/notefreq432.html)

+   [https://alijamieson.co.uk/2021/12/19/forgive-me-lord-for-i-have-synth-a-guide-to-subtractive-synthesis/](https://alijamieson.co.uk/2021/12/19/forgive-me-lord-for-i-have-synth-a-guide-to-subtractive-synthesis/)

**脚本的总运行时间：**（0分钟2.975秒）

[`下载Python源代码：oscillator_tutorial.py`](../_downloads/5479a6afc671384df1c364f38943e580/oscillator_tutorial.py)

[`下载Jupyter笔记本：oscillator_tutorial.ipynb`](../_downloads/c3b45fd5e3c80988ff7e06619382f4bb/oscillator_tutorial.ipynb)

[Sphinx-Gallery生成的画廊](https://sphinx-gallery.github.io)
