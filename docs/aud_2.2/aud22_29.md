# 加法合成

> 原文：[https://pytorch.org/audio/stable/tutorials/additive_synthesis_tutorial.html](https://pytorch.org/audio/stable/tutorials/additive_synthesis_tutorial.html)

注意

点击[这里](#sphx-glr-download-tutorials-additive-synthesis-tutorial-py)下载完整示例代码

**作者**: [Moto Hira](mailto:moto%40meta.com)

本教程是[振荡器和ADSR包络](./oscillator_tutorial.html)的延续。

本教程展示了如何使用TorchAudio的DSP函数执行加法合成和减法合成。

加法合成通过组合多个波形创建音色。减法合成通过应用滤波器创建音色。

警告

本教程需要原型DSP功能，这些功能在夜间构建中可用。

请参考[https://pytorch.org/get-started/locally](https://pytorch.org/get-started/locally) 获取安装夜间构建的说明。

```py
import torch
import torchaudio

print(torch.__version__)
print([torchaudio.__version__](https://docs.python.org/3/library/stdtypes.html#str "builtins.str")) 
```

```py
2.2.0
2.2.0 
```

## 概述[](#overview "跳转到此标题")

```py
try:
    from torchaudio.prototype.functional import adsr_envelope, extend_pitch, oscillator_bank
except ModuleNotFoundError:
    print(
        "Failed to import prototype DSP features. "
        "Please install torchaudio nightly builds. "
        "Please refer to https://pytorch.org/get-started/locally "
        "for instructions to install a nightly build."
    )
    raise

import matplotlib.pyplot as plt
from IPython.display import Audio 
```

## 创建多个频率音高[](#creating-multiple-frequency-pitches "跳转到此标题")

加法合成的核心是振荡器。我们通过将振荡器生成的多个波形相加来创建音色。

在[振荡器教程](./oscillator_tutorial.html)中，我们使用[`oscillator_bank()`](../generated/torchaudio.prototype.functional.oscillator_bank.html#torchaudio.prototype.functional.oscillator_bank "torchaudio.prototype.functional.oscillator_bank") 和 [`adsr_envelope()`](../generated/torchaudio.prototype.functional.adsr_envelope.html#torchaudio.prototype.functional.adsr_envelope "torchaudio.prototype.functional.adsr_envelope") 生成各种波形。

在本教程中，我们使用[`extend_pitch()`](../generated/torchaudio.prototype.functional.extend_pitch.html#torchaudio.prototype.functional.extend_pitch "torchaudio.prototype.functional.extend_pitch") 从基频创建音色。

首先，我们定义一些在整个教程中使用的常量和辅助函数。

```py
[PI](https://docs.python.org/3/library/functions.html#float "builtins.float") = [torch.pi](https://docs.python.org/3/library/functions.html#float "builtins.float")
[PI2](https://docs.python.org/3/library/functions.html#float "builtins.float") = 2 * [torch.pi](https://docs.python.org/3/library/functions.html#float "builtins.float")

[F0](https://docs.python.org/3/library/functions.html#float "builtins.float") = 344.0  # fundamental frequency
[DURATION](https://docs.python.org/3/library/functions.html#float "builtins.float") = 1.1  # [seconds]
[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int") = 16_000  # [Hz]

[NUM_FRAMES](https://docs.python.org/3/library/functions.html#int "builtins.int") = int([DURATION](https://docs.python.org/3/library/functions.html#float "builtins.float") * [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int")) 
```

```py
def plot([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), sample_rate, zoom=None, vol=0.1):
    t = ([torch.arange](https://pytorch.org/docs/stable/generated/torch.arange.html#torch.arange "torch.arange")([waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor").size(0)) / sample_rate).numpy()

    fig, axes = plt.subplots(4, 1, sharex=True)
    axes[0].plot(t, [freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor").numpy())
    axes[0].set(title=f"Oscillator bank (bank size: {[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor").size(-1)})", ylabel="Frequency [Hz]", ylim=[-0.03, None])
    axes[1].plot(t, [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor").numpy())
    axes[1].set(ylabel="Amplitude", ylim=[-0.03 if [torch.all](https://pytorch.org/docs/stable/generated/torch.all.html#torch.all "torch.all")([amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") >= 0.0) else None, None])
    axes[2].plot(t, [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"))
    axes[2].set(ylabel="Waveform")
    axes[3].specgram([waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), Fs=sample_rate)
    axes[3].set(ylabel="Spectrogram", xlabel="Time [s]", xlim=[-0.01, t[-1] + 0.01])

    for i in range(4):
        axes[i].grid(True)
    pos = axes[2].get_position()
    fig.tight_layout()

    if zoom is not None:
        ax = fig.add_axes([pos.x0 + 0.02, pos.y0 + 0.03, pos.width / 2.5, pos.height / 2.0])
        ax.plot(t, [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"))
        ax.set(xlim=zoom, xticks=[], yticks=[])

    [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") /= [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor").abs().max()
    return Audio(vol * [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), rate=sample_rate, normalize=False) 
```

## 谐波[](#harmonic-overtones "跳转到此标题")

谐波是基频的整数倍频率成分。

我们将看看如何生成合成器中使用的常见波形。也就是说，

> +   锯齿波
> +   
> +   方波
> +   
> +   三角波

### 锯齿波[](#sawtooth-wave "跳转到此标题")

[锯齿波](https://en.wikipedia.org/wiki/Sawtooth_wave) 可以表示为以下形式。它包含所有整数谐波，因此在减法合成中常被使用。

\[\begin{align*} y_t &= \sum_{k=1}^{K} A_k \sin ( 2 \pi f_k t ) \\ \text{其中} \\ f_k &= k f_0 \\ A_k &= -\frac{ (-1) ^k }{k \pi} \end{align*}\]

以下函数接受基频和振幅，并根据上述公式添加扩展音高。

```py
def sawtooth_wave([freq0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), num_pitches, sample_rate):
    [freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = extend_pitch([freq0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), num_pitches)

    [mults](https://docs.python.org/3/library/stdtypes.html#list "builtins.list") = [-((-1) ** i) / ([PI](https://docs.python.org/3/library/functions.html#float "builtins.float") * i) for i in range(1, 1 + num_pitches)]
    [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = extend_pitch([amp0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [mults](https://docs.python.org/3/library/stdtypes.html#list "builtins.list"))
    [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = oscillator_bank([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), sample_rate=sample_rate)
    return [freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") 
```

现在合成一个波形

```py
[freq0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [torch.full](https://pytorch.org/docs/stable/generated/torch.full.html#torch.full "torch.full")(([NUM_FRAMES](https://docs.python.org/3/library/functions.html#int "builtins.int"), 1), [F0](https://docs.python.org/3/library/functions.html#float "builtins.float"))
[amp0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [torch.ones](https://pytorch.org/docs/stable/generated/torch.ones.html#torch.ones "torch.ones")(([NUM_FRAMES](https://docs.python.org/3/library/functions.html#int "builtins.int"), 1))
[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = sawtooth_wave([freq0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), int([SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int") / [F0](https://docs.python.org/3/library/functions.html#float "builtins.float")), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"))
plot([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"), zoom=(1 / [F0](https://docs.python.org/3/library/functions.html#float "builtins.float"), 3 / [F0](https://docs.python.org/3/library/functions.html#float "builtins.float"))) 
```

![振荡器组 (组大小: 46)](../Images/f9720f8c48393179934600ac2f65389d.png)

```py
/pytorch/audio/src/torchaudio/prototype/functional/_dsp.py:63: UserWarning: Some frequencies are above nyquist frequency. Setting the corresponding amplitude to zero. This might cause numerically unstable gradient.
  warnings.warn( 
```

您的浏览器不支持音频元素。

可以振荡基频以基于锯齿波创建时变音调。

```py
[fm](https://docs.python.org/3/library/functions.html#int "builtins.int") = 10  # rate at which the frequency oscillates [Hz]
[f_dev](https://docs.python.org/3/library/functions.html#float "builtins.float") = 0.1 * [F0](https://docs.python.org/3/library/functions.html#float "builtins.float")  # the degree of frequency oscillation [Hz]

[phase](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace "torch.linspace")(0, [fm](https://docs.python.org/3/library/functions.html#int "builtins.int") * [PI2](https://docs.python.org/3/library/functions.html#float "builtins.float") * [DURATION](https://docs.python.org/3/library/functions.html#float "builtins.float"), [NUM_FRAMES](https://docs.python.org/3/library/functions.html#int "builtins.int"))
[freq0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [F0](https://docs.python.org/3/library/functions.html#float "builtins.float") + [f_dev](https://docs.python.org/3/library/functions.html#float "builtins.float") * [torch.sin](https://pytorch.org/docs/stable/generated/torch.sin.html#torch.sin "torch.sin")([phase](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor")).unsqueeze(-1)

[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = sawtooth_wave([freq0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), int([SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int") / [F0](https://docs.python.org/3/library/functions.html#float "builtins.float")), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"))
plot([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"), zoom=(1 / [F0](https://docs.python.org/3/library/functions.html#float "builtins.float"), 3 / [F0](https://docs.python.org/3/library/functions.html#float "builtins.float"))) 
```

![振荡器组 (组大小: 46)](../Images/f7f81fb888b8651e7597a2d93fca1647.png)

```py
/pytorch/audio/src/torchaudio/prototype/functional/_dsp.py:63: UserWarning: Some frequencies are above nyquist frequency. Setting the corresponding amplitude to zero. This might cause numerically unstable gradient.
  warnings.warn( 
```

您的浏览器不支持音频元素。

### 方波[](#square-wave "跳转到此标题")

[方波](https://en.wikipedia.org/wiki/Square_wave) 仅包含奇整数谐波。

\[\begin{align*} y_t &= \sum_{k=0}^{K-1} A_k \sin ( 2 \pi f_k t ) \\ \text{其中} \\ f_k &= n f_0 \\ A_k &= \frac{ 4 }{n \pi} \\ n &= 2k + 1 \end{align*}\]

```py
def square_wave([freq0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), num_pitches, sample_rate):
    [mults](https://docs.python.org/3/library/stdtypes.html#list "builtins.list") = [2.0 * i + 1.0 for i in range(num_pitches)]
    [freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = extend_pitch([freq0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [mults](https://docs.python.org/3/library/stdtypes.html#list "builtins.list"))

    [mults](https://docs.python.org/3/library/stdtypes.html#list "builtins.list") = [4 / ([PI](https://docs.python.org/3/library/functions.html#float "builtins.float") * (2.0 * i + 1.0)) for i in range(num_pitches)]
    [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = extend_pitch([amp0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [mults](https://docs.python.org/3/library/stdtypes.html#list "builtins.list"))

    [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = oscillator_bank([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), sample_rate=sample_rate)
    return [freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") 
```

```py
[freq0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [torch.full](https://pytorch.org/docs/stable/generated/torch.full.html#torch.full "torch.full")(([NUM_FRAMES](https://docs.python.org/3/library/functions.html#int "builtins.int"), 1), [F0](https://docs.python.org/3/library/functions.html#float "builtins.float"))
[amp0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [torch.ones](https://pytorch.org/docs/stable/generated/torch.ones.html#torch.ones "torch.ones")(([NUM_FRAMES](https://docs.python.org/3/library/functions.html#int "builtins.int"), 1))
[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = square_wave([freq0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), int([SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int") / [F0](https://docs.python.org/3/library/functions.html#float "builtins.float") / 2), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"))
plot([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"), zoom=(1 / [F0](https://docs.python.org/3/library/functions.html#float "builtins.float"), 3 / [F0](https://docs.python.org/3/library/functions.html#float "builtins.float"))) 
```

![振荡器组 (组大小: 23)](../Images/34cee6f4901289e37a7b4caea5db81ec.png)

```py
/pytorch/audio/src/torchaudio/prototype/functional/_dsp.py:63: UserWarning: Some frequencies are above nyquist frequency. Setting the corresponding amplitude to zero. This might cause numerically unstable gradient.
  warnings.warn( 
```

您的浏览器不支持音频元素。

### 三角波[](#triangle-wave "跳转到此标题")

[三角波](https://en.wikipedia.org/wiki/Triangle_wave) 也仅包含奇整数谐波。

\[\begin{align*} y_t &= \sum_{k=0}^{K-1} A_k \sin ( 2 \pi f_k t ) \\ \text{其中} \\ f_k &= n f_0 \\ A_k &= (-1) ^ k \frac{8}{(n\pi) ^ 2} \\ n &= 2k + 1 \end{align*}\]

```py
def triangle_wave([freq0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), num_pitches, sample_rate):
    [mults](https://docs.python.org/3/library/stdtypes.html#list "builtins.list") = [2.0 * i + 1.0 for i in range(num_pitches)]
    [freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = extend_pitch([freq0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [mults](https://docs.python.org/3/library/stdtypes.html#list "builtins.list"))

    c = 8 / ([PI](https://docs.python.org/3/library/functions.html#float "builtins.float")**2)
    [mults](https://docs.python.org/3/library/stdtypes.html#list "builtins.list") = [c * ((-1) ** i) / ((2.0 * i + 1.0) ** 2) for i in range(num_pitches)]
    [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = extend_pitch([amp0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [mults](https://docs.python.org/3/library/stdtypes.html#list "builtins.list"))

    [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = oscillator_bank([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), sample_rate=sample_rate)
    return [freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") 
```

```py
[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = triangle_wave([freq0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), int([SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int") / [F0](https://docs.python.org/3/library/functions.html#float "builtins.float") / 2), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"))
plot([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"), zoom=(1 / [F0](https://docs.python.org/3/library/functions.html#float "builtins.float"), 3 / [F0](https://docs.python.org/3/library/functions.html#float "builtins.float"))) 
```

![振荡器银行（银行大小：23）](../Images/eef0b52ccbd6c4cf4e303036f0fc2863.png)

```py
/pytorch/audio/src/torchaudio/prototype/functional/_dsp.py:63: UserWarning: Some frequencies are above nyquist frequency. Setting the corresponding amplitude to zero. This might cause numerically unstable gradient.
  warnings.warn( 
```

您的浏览器不支持音频元素。

## 非谐波部分[](#inharmonic-paritials "Permalink to this heading")

非谐波部分指的是不是基频的整数倍的频率。

它们对于重新创建逼真的声音或使合成结果更有趣至关重要。

### 钟声[](#bell-sound "Permalink to this heading")

[https://computermusicresource.com/Simple.bell.tutorial.html](https://computermusicresource.com/Simple.bell.tutorial.html)

```py
[num_tones](https://docs.python.org/3/library/functions.html#int "builtins.int") = 9
[duration](https://docs.python.org/3/library/functions.html#float "builtins.float") = 2.0
[num_frames](https://docs.python.org/3/library/functions.html#int "builtins.int") = int([SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int") * [duration](https://docs.python.org/3/library/functions.html#float "builtins.float"))

[freq0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [torch.full](https://pytorch.org/docs/stable/generated/torch.full.html#torch.full "torch.full")(([num_frames](https://docs.python.org/3/library/functions.html#int "builtins.int"), 1), [F0](https://docs.python.org/3/library/functions.html#float "builtins.float"))
[mults](https://docs.python.org/3/library/stdtypes.html#list "builtins.list") = [0.56, 0.92, 1.19, 1.71, 2, 2.74, 3.0, 3.76, 4.07]
[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = extend_pitch([freq0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [mults](https://docs.python.org/3/library/stdtypes.html#list "builtins.list"))

[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = adsr_envelope(
    [num_frames](https://docs.python.org/3/library/functions.html#int "builtins.int")=[num_frames](https://docs.python.org/3/library/functions.html#int "builtins.int"),
    attack=0.002,
    decay=0.998,
    sustain=0.0,
    release=0.0,
    n_decay=2,
)
[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = [torch.stack](https://pytorch.org/docs/stable/generated/torch.stack.html#torch.stack "torch.stack")([[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") * (0.5**i) for i in range([num_tones](https://docs.python.org/3/library/functions.html#int "builtins.int"))], dim=-1)

[waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = oscillator_bank([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), sample_rate=[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"))

plot([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"), vol=0.4) 
```

![振荡器银行（银行大小：9）](../Images/4787059407ae32c1a6aaaa83903ac56b.png)

您的浏览器不支持音频元素。

作为对比，以下是上述内容的谐波版本。只有频率值不同。泛音的数量和幅度相同。

```py
[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = extend_pitch([freq0](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [num_tones](https://docs.python.org/3/library/functions.html#int "builtins.int"))
[waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor") = oscillator_bank([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), sample_rate=[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int"))

plot([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor "torch.Tensor"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int "builtins.int")) 
```

![振荡器银行（银行大小：9）](../Images/73f01544734dc7809b6d987ccdae6c7f.png)

您的浏览器不支持音频元素。

## 参考资料[](#references "Permalink to this heading")

+   [https://en.wikipedia.org/wiki/Additive_synthesis](https://en.wikipedia.org/wiki/Additive_synthesis)

+   [https://computermusicresource.com/Simple.bell.tutorial.html](https://computermusicresource.com/Simple.bell.tutorial.html)

+   [https://computermusicresource.com/Definitions/additive.synthesis.html](https://computermusicresource.com/Definitions/additive.synthesis.html)

**脚本的总运行时间：**（0分钟4.662秒）

[`Download Python source code: additive_synthesis_tutorial.py`](../_downloads/3b47d1fda1ff1ba89f9df8fcc2d3ba6d/additive_synthesis_tutorial.py)

[`Download Jupyter笔记本：additive_synthesis_tutorial.ipynb`](../_downloads/d2ec3ac999c9665c76413f1e36232990/additive_synthesis_tutorial.ipynb)

[Sphinx-Gallery生成的画廊](https://sphinx-gallery.github.io)
