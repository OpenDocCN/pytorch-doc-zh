- en: SST-2 Binary text classification with XLM-RoBERTa model
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://pytorch.org/text/stable/tutorials/sst2_classification_non_distributed.html](https://pytorch.org/text/stable/tutorials/sst2_classification_non_distributed.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Note
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: Click [here](#sphx-glr-download-tutorials-sst2-classification-non-distributed-py)
    to download the full example code
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
- en: '**Author**: [Parmeet Bhatia](mailto:parmeetbhatia%40fb.com)'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
- en: Overview[](#overview "Permalink to this heading")
  id: totrans-5
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'This tutorial demonstrates how to train a text classifier on SST-2 binary dataset
    using a pre-trained XLM-RoBERTa (XLM-R) model. We will show how to use torchtext
    library to:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
- en: build text pre-processing pipeline for XLM-R model
  id: totrans-7
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: read SST-2 dataset and transform it using text and label transformation
  id: totrans-8
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: instantiate classification model using pre-trained XLM-R encoder
  id: totrans-9
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Common imports[](#common-imports "Permalink to this heading")
  id: totrans-10
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-11
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Data Transformation[](#data-transformation "Permalink to this heading")
  id: totrans-12
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Models like XLM-R cannot work directly with raw text. The first step in training
    these models is to transform input text into tensor (numerical) form such that
    it can then be processed by models to make predictions. A standard way to process
    text is:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
- en: Tokenize text
  id: totrans-14
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Convert tokens into (integer) IDs
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Add any special tokens IDs
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: XLM-R uses sentencepiece model for text tokenization. Below, we use pre-trained
    sentencepiece model along with corresponding vocabulary to build text pre-processing
    pipeline using torchtext’s transforms. The transforms are pipelined using [`torchtext.transforms.Sequential()`](../transforms.html#torchtext.transforms.Sequential
    "torchtext.transforms.Sequential") which is similar to `torch.nn.Sequential()`
    but is torchscriptable. Note that the transforms support both batched and non-batched
    text inputs i.e, one can either pass a single sentence or list of sentences.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  id: totrans-18
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Alternately we can also use transform shipped with pre-trained model that does
    all of the above out-of-the-box
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Dataset[](#dataset "Permalink to this heading")
  id: totrans-21
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: torchtext provides several standard NLP datasets. For complete list, refer to
    documentation at [https://pytorch.org/text/stable/datasets.html](https://pytorch.org/text/stable/datasets.html).
    These datasets are build using composable torchdata datapipes and hence support
    standard flow-control and mapping/transformation using user defined functions
    and transforms. Below, we demonstrate how to use text and label processing transforms
    to pre-process the SST-2 dataset.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
- en: Note
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
- en: Using datapipes is still currently subject to a few caveats. If you wish to
    extend this example to include shuffling, multi-processing, or distributed learning,
    please see [this note](../datasets.html#datapipes-warnings) for further instructions.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Alternately we can also use batched API (i.e apply transformation on the whole
    batch)
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  id: totrans-27
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Model Preparation[](#model-preparation "Permalink to this heading")
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: torchtext provides SOTA pre-trained models that can be used to fine-tune on
    downstream NLP tasks. Below we use pre-trained XLM-R encoder with standard base
    architecture and attach a classifier head to fine-tune it on SST-2 binary classification
    task. We shall use standard Classifier head from the library, but users can define
    their own appropriate task head and attach it to the pre-trained encoder. For
    additional details on available pre-trained models, please refer to documentation
    at [https://pytorch.org/text/main/models.html](https://pytorch.org/text/main/models.html)
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Training methods[](#training-methods "Permalink to this heading")
  id: totrans-31
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Let’s now define the standard optimizer and training criteria as well as some
    helper functions for training and evaluation
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Train[](#train "Permalink to this heading")
  id: totrans-34
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Now we have all the ingredients to train our classification model. Note that
    we are able to directly iterate on our dataset object without using DataLoader.
    Our pre-process dataset shall yield batches of data already, thanks to the batching
    datapipe we have applied. For distributed training, we would need to use DataLoader
    to take care of data-sharding.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有了训练分类模型的所有要素。请注意，我们可以直接在数据集对象上进行迭代，而无需使用DataLoader。由于我们应用了批处理数据管道，我们的预处理数据集应该已经产生了数据批次。对于分布式训练，我们需要使用DataLoader来处理数据分片。
- en: '[PRE7]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Output[](#output "Permalink to this heading")
  id: totrans-37
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 输出[](#output "到这个标题的永久链接")
- en: '[PRE8]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '**Total running time of the script:** ( 0 minutes 0.000 seconds)'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本的总运行时间：（0分钟0.000秒）
- en: '[`Download Python source code: sst2_classification_non_distributed.py`](../_downloads/4bb41c115b7ab0e9392abf45c7eee83b/sst2_classification_non_distributed.py)'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: '[`下载Python源代码：sst2_classification_non_distributed.py`](../_downloads/4bb41c115b7ab0e9392abf45c7eee83b/sst2_classification_non_distributed.py)'
- en: '[`Download Jupyter notebook: sst2_classification_non_distributed.ipynb`](../_downloads/764dcd36c4948c7e9a28df09d761099d/sst2_classification_non_distributed.ipynb)'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: '[`下载Jupyter笔记本：sst2_classification_non_distributed.ipynb`](../_downloads/764dcd36c4948c7e9a28df09d761099d/sst2_classification_non_distributed.ipynb)'
- en: '[Gallery generated by Sphinx-Gallery](https://sphinx-gallery.github.io)'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: '[Sphinx-Gallery生成的图库](https://sphinx-gallery.github.io)'
