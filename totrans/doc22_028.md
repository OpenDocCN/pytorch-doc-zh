# C++

> 原文：[https://pytorch.org/docs/stable/cpp_index.html](https://pytorch.org/docs/stable/cpp_index.html)

注意

如果您正在寻找PyTorch C++ API文档，请直接前往[此处](https://pytorch.org/cppdocs/)。

PyTorch提供了几个用于处理C++的功能，最好根据您的需求选择其中之一。在高层次上，以下支持可用：

## TorchScript C++ API

[TorchScript](https://pytorch.org/docs/stable/jit.html)允许将在Python中定义的PyTorch模型序列化，然后在C++中加载和运行，通过编译或跟踪其执行来捕获模型代码。您可以在[在C++中加载TorchScript模型](https://pytorch.org/tutorials/advanced/cpp_export.html)教程中了解更多信息。这意味着您可以尽可能在Python中定义模型，但随后通过TorchScript导出它们，以在生产或嵌入式环境中进行无Python执行。TorchScript C++ API用于与这些模型和TorchScript执行引擎进行交互，包括：

+   加载从Python保存的序列化TorchScript模型

+   如果需要，进行简单的模型修改（例如，提取子模块）

+   使用C++ Tensor API构建输入并进行预处理

## 使用C++扩展扩展PyTorch和TorchScript[](#extending-pytorch-and-torchscript-with-c-extensions "跳转到此标题的永久链接")

TorchScript可以通过自定义运算符和自定义类增强用户提供的代码。一旦在TorchScript中注册了这些运算符和类，这些运算符和类可以在Python中运行的TorchScript代码中被调用，或者作为序列化的TorchScript模型的一部分在C++中被调用。[使用自定义C++运算符扩展TorchScript](https://pytorch.org/tutorials/advanced/torch_script_custom_ops.html)教程介绍了如何将TorchScript与OpenCV进行接口。除了使用自定义运算符包装函数调用外，C++类和结构体还可以通过类似于pybind11的接口绑定到TorchScript中，这在[使用自定义C++类扩展TorchScript](https://pytorch.org/tutorials/advanced/torch_script_custom_classes.html)教程中有解释。

## 在C++中的Tensor和Autograd

PyTorch Python API中的大多数张量和自动求导操作也可在C++ API中使用。包括：

+   `torch::Tensor`方法，如`add` / `reshape` / `clone`。有关可用方法的完整列表，请参阅：[https://pytorch.org/cppdocs/api/classat_1_1_tensor.html](https://pytorch.org/cppdocs/api/classat_1_1_tensor.html)

+   C++张量索引API，看起来和行为与Python API相同。有关其用法的详细信息，请参阅：[https://pytorch.org/cppdocs/notes/tensor_indexing.html](https://pytorch.org/cppdocs/notes/tensor_indexing.html)

+   在C++前端构建动态神经网络至关重要的张量自动求导API和`torch::autograd`包。有关更多详细信息，请参阅：[https://pytorch.org/tutorials/advanced/cpp_autograd.html](https://pytorch.org/tutorials/advanced/cpp_autograd.html)

## 在C++中编写模型

“在TorchScript中编写，使用C++进行推断”的工作流程要求在TorchScript中进行模型编写。但是，可能存在必须在C++中编写模型的情况（例如，在不希望使用Python组件的工作流程中）。为了满足这种用例，我们提供了在C++中完全编写和训练神经网络模型的完整功能，其中包括`torch::nn` / `torch::nn::functional` / `torch::optim`等熟悉的组件，这些组件与Python API非常相似。

+   有关PyTorch C++模型编写和训练API的概述，请参阅：[https://pytorch.org/cppdocs/frontend.html](https://pytorch.org/cppdocs/frontend.html)

+   有关如何使用API的详细教程，请参阅：[https://pytorch.org/tutorials/advanced/cpp_frontend.html](https://pytorch.org/tutorials/advanced/cpp_frontend.html)

+   有关诸如`torch::nn` / `torch::nn::functional` / `torch::optim`等组件的文档，请访问：[https://pytorch.org/cppdocs/api/library_root.html](https://pytorch.org/cppdocs/api/library_root.html)

## C++包装

有关如何安装和链接libtorch（包含所有上述C++ API的库）的指导，请参阅：[https://pytorch.org/cppdocs/installing.html](https://pytorch.org/cppdocs/installing.html)。请注意，在Linux上提供了两种类型的libtorch二进制文件：一种是使用GCC pre-cxx11 ABI编译的，另一种是使用GCC cxx11 ABI编译的，您应该根据系统使用的GCC ABI进行选择。
