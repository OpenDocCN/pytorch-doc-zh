["```py\nimport torch\nimport torchaudio\n\nprint(torch.__version__)\nprint([torchaudio.__version__](https://docs.python.org/3/library/stdtypes.html#str \"builtins.str\"))\n\nimport matplotlib.pyplot as plt \n```", "```py\n2.2.0\n2.2.0 \n```", "```py\nfrom torchaudio.prototype.functional import frequency_impulse_response, sinc_impulse_response \n```", "```py\n[cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(0.0, 1.0, 9)\n[irs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = sinc_impulse_response([cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), window_size=513)\n\nprint(\"Cutoff shape:\", [cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").shape)\nprint(\"Impulse response shape:\", [irs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").shape) \n```", "```py\nCutoff shape: torch.Size([9])\nImpulse response shape: torch.Size([9, 513]) \n```", "```py\ndef plot_sinc_ir([irs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")):\n    num_filts, window_size = [irs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").shape\n    half = window_size // 2\n\n    fig, axes = plt.subplots(num_filts, 1, sharex=True, figsize=(9.6, 8))\n    t = [torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(-half, half - 1, window_size)\n    for ax, [ir](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [coff](https://docs.python.org/3/library/stdtypes.html#list \"builtins.list\"), color in zip(axes, [irs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [plt.cm.tab10.colors](https://docs.python.org/3/library/stdtypes.html#tuple \"builtins.tuple\")):\n        ax.plot(t, [ir](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), linewidth=1.2, color=color, zorder=4, label=f\"Cutoff: {[coff](https://docs.python.org/3/library/stdtypes.html#list \"builtins.list\")}\")\n        ax.legend(loc=(1.05, 0.2), handletextpad=0, handlelength=0)\n        ax.grid(True)\n    fig.suptitle(\n        \"Impulse response of sinc low-pass filter for different cut-off frequencies\\n\"\n        \"(Frequencies are relative to Nyquist frequency)\"\n    )\n    axes[-1].set_xticks([i * half // 4 for i in range(-4, 5)])\n    fig.tight_layout() \n```", "```py\nplot_sinc_ir([irs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")) \n```", "```py\n[frs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.fft.rfft](https://pytorch.org/docs/stable/generated/torch.fft.rfft.html#torch.fft.rfft \"torch.fft.rfft\")([irs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), n=2048, dim=1).abs() \n```", "```py\ndef plot_sinc_fr([frs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), band=False):\n    num_filts, num_fft = [frs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").shape\n    num_ticks = num_filts + 1 if band else num_filts\n\n    fig, axes = plt.subplots(num_filts, 1, sharex=True, sharey=True, figsize=(9.6, 8))\n    for ax, fr, [coff](https://docs.python.org/3/library/stdtypes.html#list \"builtins.list\"), color in zip(axes, [frs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [plt.cm.tab10.colors](https://docs.python.org/3/library/stdtypes.html#tuple \"builtins.tuple\")):\n        ax.grid(True)\n        ax.semilogy(fr, color=color, zorder=4, label=f\"Cutoff: {[coff](https://docs.python.org/3/library/stdtypes.html#list \"builtins.list\")}\")\n        ax.legend(loc=(1.05, 0.2), handletextpad=0, handlelength=0).set_zorder(3)\n    axes[-1].set(\n        ylim=[None, 100],\n        yticks=[1e-9, 1e-6, 1e-3, 1],\n        xticks=[torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(0, num_fft, num_ticks),\n        xticklabels=[f\"{i/(num_ticks  -  1)}\" for i in range(num_ticks)],\n        xlabel=\"Frequency\",\n    )\n    fig.suptitle(\n        \"Frequency response of sinc low-pass filter for different cut-off frequencies\\n\"\n        \"(Frequencies are relative to Nyquist frequency)\"\n    )\n    fig.tight_layout() \n```", "```py\nplot_sinc_fr([frs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")) \n```", "```py\n[irs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = sinc_impulse_response([cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), window_size=513, high_pass=True)\n[frs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.fft.rfft](https://pytorch.org/docs/stable/generated/torch.fft.rfft.html#torch.fft.rfft \"torch.fft.rfft\")([irs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), n=2048, dim=1).abs() \n```", "```py\nplot_sinc_ir([irs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")) \n```", "```py\nplot_sinc_fr([frs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")) \n```", "```py\n[cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(0.0, 1, 11)\n[c_low](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")[:-1]\n[c_high](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")[1:]\n\n[irs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = sinc_impulse_response([c_low](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), window_size=513) - sinc_impulse_response([c_high](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), window_size=513)\n[frs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.fft.rfft](https://pytorch.org/docs/stable/generated/torch.fft.rfft.html#torch.fft.rfft \"torch.fft.rfft\")([irs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), n=2048, dim=1).abs() \n```", "```py\n[coff](https://docs.python.org/3/library/stdtypes.html#list \"builtins.list\") = [f\"{l.item():.1f}, {h.item():.1f}\" for l, h in zip([c_low](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [c_high](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"))]\nplot_sinc_ir([irs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [coff](https://docs.python.org/3/library/stdtypes.html#list \"builtins.list\")) \n```", "```py\nplot_sinc_fr([frs](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [coff](https://docs.python.org/3/library/stdtypes.html#list \"builtins.list\"), band=True) \n```", "```py\n[magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.concat](https://pytorch.org/docs/stable/generated/torch.concat.html#torch.concat \"torch.concat\")([[torch.ones](https://pytorch.org/docs/stable/generated/torch.ones.html#torch.ones \"torch.ones\")((128,)), [torch.zeros](https://pytorch.org/docs/stable/generated/torch.zeros.html#torch.zeros \"torch.zeros\")((128,))])\n[ir](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = frequency_impulse_response([magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"))\n\nprint(\"Magnitudes:\", [magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").shape)\nprint(\"Impulse Response:\", [ir](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").shape) \n```", "```py\nMagnitudes: torch.Size([256])\nImpulse Response: torch.Size([510]) \n```", "```py\ndef plot_ir([magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [ir](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), num_fft=2048):\n    fr = [torch.fft.rfft](https://pytorch.org/docs/stable/generated/torch.fft.rfft.html#torch.fft.rfft \"torch.fft.rfft\")([ir](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), n=num_fft, dim=0).abs()\n    ir_size = [ir](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").size(-1)\n    half = ir_size // 2\n\n    fig, axes = plt.subplots(3, 1)\n    t = [torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(-half, half - 1, ir_size)\n    axes[0].plot(t, [ir](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"))\n    axes[0].grid(True)\n    axes[0].set(title=\"Impulse Response\")\n    axes[0].set_xticks([i * half // 4 for i in range(-4, 5)])\n    t = [torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(0, 1, fr.numel())\n    axes[1].plot(t, fr, label=\"Actual\")\n    axes[2].semilogy(t, fr, label=\"Actual\")\n    t = [torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(0, 1, [magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").numel())\n    for i in range(1, 3):\n        axes[i].plot(t, [magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), label=\"Desired (input)\", linewidth=1.1, linestyle=\"--\")\n        axes[i].grid(True)\n    axes[1].set(title=\"Frequency Response\")\n    axes[2].set(title=\"Frequency Response (log-scale)\", xlabel=\"Frequency\")\n    axes[2].legend(loc=\"center right\")\n    fig.tight_layout() \n```", "```py\nplot_ir([magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [ir](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")) \n```", "```py\n[magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.concat](https://pytorch.org/docs/stable/generated/torch.concat.html#torch.concat \"torch.concat\")([[torch.ones](https://pytorch.org/docs/stable/generated/torch.ones.html#torch.ones \"torch.ones\")((32,)), [torch.zeros](https://pytorch.org/docs/stable/generated/torch.zeros.html#torch.zeros \"torch.zeros\")((32,))])\n[ir](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = frequency_impulse_response([magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")) \n```", "```py\nplot_ir([magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [ir](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")) \n```", "```py\n[magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(0, 1, 64) ** 4.0\n[ir](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = frequency_impulse_response([magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")) \n```", "```py\nplot_ir([magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [ir](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")) \n```", "```py\n[magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.sin](https://pytorch.org/docs/stable/generated/torch.sin.html#torch.sin \"torch.sin\")([torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(0, 10, 64)) ** 4.0\n[ir](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = frequency_impulse_response([magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")) \n```", "```py\nplot_ir([magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [ir](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")) \n```"]