# torch.func

> 原文：[https://pytorch.org/docs/stable/func.html](https://pytorch.org/docs/stable/func.html)

torch.func，以前称为“functorch”，是PyTorch的[JAX-like](https://github.com/google/jax)可组合函数变换。

注意

该库目前处于[测试版](https://pytorch.org/blog/pytorch-feature-classification-changes/#beta)。这意味着功能通常可用（除非另有说明），我们（PyTorch团队）致力于推进该库。但是，API可能会根据用户反馈进行更改，我们对PyTorch操作的覆盖范围不完整。

如果您对API或用例有建议，请打开GitHub问题或联系我们。我们很乐意听听您如何使用库。

## 什么是可组合的函数变换？[](#what-are-composable-function-transforms "跳转到此标题")

+   “函数变换”是一个高阶函数，接受一个数值函数并返回一个计算不同量的新函数。

+   [`torch.func`](func.api.html#module-torch.func "torch.func")具有自动微分变换（`grad(f)`返回一个计算`f`梯度的函数），矢量化/批处理变换（`vmap(f)`返回一个计算输入批次上的`f`的函数）等。

+   这些函数变换可以任意组合。例如，组合`vmap(grad(f))`计算一种称为每样本梯度的量，目前原始PyTorch无法高效计算。

## 为什么使用可组合的函数变换？[](#why-composable-function-transforms "跳转到此标题")

目前在PyTorch中有一些棘手的用例：

+   计算每样本梯度（或其他每样本量）

+   在单台机器上运行模型集合

+   在MAML的内循环中高效批处理任务

+   高效计算雅可比矩阵和海森矩阵

+   高效计算批量雅可比矩阵和海森矩阵

组合[`vmap()`](generated/torch.func.vmap.html#torch.func.vmap "torch.func.vmap")、[`grad()`](generated/torch.func.grad.html#torch.func.grad "torch.func.grad")和[`vjp()`](generated/torch.func.vjp.html#torch.func.vjp "torch.func.vjp")变换使我们能够表达上述内容，而无需为每个设计单独的子系统。这种可组合函数变换的想法来自[JAX框架](https://github.com/google/jax)。

## 阅读更多

+   [torch.func快速浏览](func.whirlwind_tour.html)

    +   [什么是torch.func？](func.whirlwind_tour.html#what-is-torch-func)

    +   [为什么使用可组合的函数变换？](func.whirlwind_tour.html#why-composable-function-transforms)

    +   [什么是变换？](func.whirlwind_tour.html#what-are-the-transforms)

+   [torch.func API参考](func.api.html)

    +   [函数变换](func.api.html#function-transforms)

    +   [与torch.nn.Modules一起工作的实用程序](func.api.html#utilities-for-working-with-torch-nn-modules)

+   [用户体验限制](func.ux_limitations.html)

    +   [一般限制](func.ux_limitations.html#general-limitations)

    +   [torch.autograd API](func.ux_limitations.html#torch-autograd-apis)

    +   [vmap限制](func.ux_limitations.html#vmap-limitations)

    +   [随机性](func.ux_limitations.html#randomness)

+   [从functorch迁移到torch.func](func.migrating.html)

    +   [函数变换](func.migrating.html#function-transforms)

    +   [NN模块实用程序](func.migrating.html#nn-module-utilities)

    +   [functorch.compile](func.migrating.html#functorch-compile)
