- en: Trace Diff using Holistic Trace Analysis
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://pytorch.org/tutorials/beginner/hta_trace_diff_tutorial.html](https://pytorch.org/tutorials/beginner/hta_trace_diff_tutorial.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**Author:** [Anupam Bhatnagar](https://github.com/anupambhatnagar)'
  prefs: []
  type: TYPE_NORMAL
- en: Occasionally, users need to identify the changes in PyTorch operators and CUDA
    kernels resulting from a code change. To support this requirement, HTA provides
    a trace comparison feature. This feature allows the user to input two sets of
    trace files where the first can be thought of as the *control group* and the second
    as the *test group*, similar to an A/B test. The `TraceDiff` class provides functions
    to compare the differences between traces and functionality to visualize these
    differences. In particular, users can find operators and kernels that were added
    and removed from each group, along with the frequency of each operator/kernel
    and the cumulative time taken by the operator/kernel.
  prefs: []
  type: TYPE_NORMAL
- en: 'The [TraceDiff](https://hta.readthedocs.io/en/latest/source/api/trace_diff_api.html)
    class has the following methods:'
  prefs: []
  type: TYPE_NORMAL
- en: '[compare_traces](https://hta.readthedocs.io/en/latest/source/api/trace_diff_api.html#hta.trace_diff.TraceDiff.compare_traces):
    Compare the frequency and total duration of CPU operators and GPU kernels from
    two sets of traces.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[ops_diff](https://hta.readthedocs.io/en/latest/source/api/trace_diff_api.html#hta.trace_diff.TraceDiff.ops_diff):
    Get the operators and kernels which have been:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**added** to the test trace and are absent in the control trace'
  prefs:
  - PREF_IND
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_IND
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_IND
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '**deleted** from the test trace and are present in the control trace'
  prefs:
  - PREF_IND
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_IND
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_IND
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '**increased** in frequency in the test trace and exist in the control trace'
  prefs:
  - PREF_IND
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_IND
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_IND
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '**decreased** in frequency in the test trace and exist in the control trace'
  prefs:
  - PREF_IND
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_IND
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_IND
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '**unchanged** between the two sets of traces'
  prefs:
  - PREF_IND
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
- en: '[visualize_counts_diff](https://hta.readthedocs.io/en/latest/source/api/trace_diff_api.html#hta.trace_diff.TraceDiff.visualize_counts_diff)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[visualize_duration_diff](https://hta.readthedocs.io/en/latest/source/api/trace_diff_api.html#hta.trace_diff.TraceDiff.visualize_duration_diff)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The last two methods can be used to visualize various changes in frequency and
    duration of CPU operators and GPU kernels, using the output of the `compare_traces`
    method.
  prefs: []
  type: TYPE_NORMAL
- en: 'For example, the top ten operators with increase in frequency can be computed
    as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '![../_images/counts_diff.png](../Images/8ba7a34a81fdec8189722df7c9895675.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Similarly, the top ten operators with the largest change in duration can be
    computed as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '![../_images/duration_diff.png](../Images/e623103bec502426b3540b481b474ce7.png)'
  prefs: []
  type: TYPE_IMG
- en: For a detailed example of this feature see the [trace_diff_demo notebook](https://github.com/facebookresearch/HolisticTraceAnalysis/blob/main/examples/trace_diff_demo.ipynb)
    in the examples folder of the repository.
  prefs: []
  type: TYPE_NORMAL
