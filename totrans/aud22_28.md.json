["```py\nimport torch\nimport torchaudio\n\nprint(torch.__version__)\nprint([torchaudio.__version__](https://docs.python.org/3/library/stdtypes.html#str \"builtins.str\")) \n```", "```py\n2.2.0\n2.2.0 \n```", "```py\ntry:\n    from torchaudio.prototype.functional import adsr_envelope, oscillator_bank\nexcept ModuleNotFoundError:\n    print(\n        \"Failed to import prototype DSP features. \"\n        \"Please install torchaudio nightly builds. \"\n        \"Please refer to https://pytorch.org/get-started/locally \"\n        \"for instructions to install a nightly build.\"\n    )\n    raise\n\nimport math\n\nimport matplotlib.pyplot as plt\nfrom IPython.display import Audio\n\n[PI](https://docs.python.org/3/library/functions.html#float \"builtins.float\") = [torch.pi](https://docs.python.org/3/library/functions.html#float \"builtins.float\")\n[PI2](https://docs.python.org/3/library/functions.html#float \"builtins.float\") = 2 * [torch.pi](https://docs.python.org/3/library/functions.html#float \"builtins.float\") \n```", "```py\n[F0](https://docs.python.org/3/library/functions.html#float \"builtins.float\") = 344.0  # fundamental frequency\n[DURATION](https://docs.python.org/3/library/functions.html#float \"builtins.float\") = 1.1  # [seconds]\n[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\") = 16_000  # [Hz]\n\n[NUM_FRAMES](https://docs.python.org/3/library/functions.html#int \"builtins.int\") = int([DURATION](https://docs.python.org/3/library/functions.html#float \"builtins.float\") * [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\")) \n```", "```py\ndef show([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), sample_rate, zoom=None, vol=0.3):\n    t = ([torch.arange](https://pytorch.org/docs/stable/generated/torch.arange.html#torch.arange \"torch.arange\")([waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").size(0)) / sample_rate).numpy()\n\n    fig, axes = plt.subplots(4, 1, sharex=True)\n    axes[0].plot(t, [freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").numpy())\n    axes[0].set(title=f\"Oscillator bank (bank size: {[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").size(-1)})\", ylabel=\"Frequency [Hz]\", ylim=[-0.03, None])\n    axes[1].plot(t, [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").numpy())\n    axes[1].set(ylabel=\"Amplitude\", ylim=[-0.03 if [torch.all](https://pytorch.org/docs/stable/generated/torch.all.html#torch.all \"torch.all\")([amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") >= 0.0) else None, None])\n    axes[2].plot(t, [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").numpy())\n    axes[2].set(ylabel=\"Waveform\")\n    axes[3].specgram([waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), Fs=sample_rate)\n    axes[3].set(ylabel=\"Spectrogram\", xlabel=\"Time [s]\", xlim=[-0.01, t[-1] + 0.01])\n\n    for i in range(4):\n        axes[i].grid(True)\n    pos = axes[2].get_position()\n    plt.tight_layout()\n\n    if zoom is not None:\n        ax = fig.add_axes([pos.x0 + 0.01, pos.y0 + 0.03, pos.width / 2.5, pos.height / 2.0])\n        ax.plot(t, [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"))\n        ax.set(xlim=zoom, xticks=[], yticks=[])\n\n    [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") /= [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").abs().max()\n    return Audio(vol * [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), rate=sample_rate, normalize=False) \n```", "```py\n[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.full](https://pytorch.org/docs/stable/generated/torch.full.html#torch.full \"torch.full\")(([NUM_FRAMES](https://docs.python.org/3/library/functions.html#int \"builtins.int\"), 1), [F0](https://docs.python.org/3/library/functions.html#float \"builtins.float\"))\n[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.ones](https://pytorch.org/docs/stable/generated/torch.ones.html#torch.ones \"torch.ones\")(([NUM_FRAMES](https://docs.python.org/3/library/functions.html#int \"builtins.int\"), 1))\n\n[waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = oscillator_bank([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), sample_rate=[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\"))\n\nshow([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\"), zoom=(1 / [F0](https://docs.python.org/3/library/functions.html#float \"builtins.float\"), 3 / [F0](https://docs.python.org/3/library/functions.html#float \"builtins.float\"))) \n```", "```py\n[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.empty](https://pytorch.org/docs/stable/generated/torch.empty.html#torch.empty \"torch.empty\")(([NUM_FRAMES](https://docs.python.org/3/library/functions.html#int \"builtins.int\"), 3))\n[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")[:, 0] = [F0](https://docs.python.org/3/library/functions.html#float \"builtins.float\")\n[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")[:, 1] = 3 * [F0](https://docs.python.org/3/library/functions.html#float \"builtins.float\")\n[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")[:, 2] = 5 * [F0](https://docs.python.org/3/library/functions.html#float \"builtins.float\")\n\n[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.ones](https://pytorch.org/docs/stable/generated/torch.ones.html#torch.ones \"torch.ones\")(([NUM_FRAMES](https://docs.python.org/3/library/functions.html#int \"builtins.int\"), 3)) / 3\n\n[waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = oscillator_bank([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), sample_rate=[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\"))\n\nshow([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\"), zoom=(1 / [F0](https://docs.python.org/3/library/functions.html#float \"builtins.float\"), 3 / [F0](https://docs.python.org/3/library/functions.html#float \"builtins.float\"))) \n```", "```py\n[nyquist_freq](https://docs.python.org/3/library/functions.html#float \"builtins.float\") = [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\") / 2\n[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.logspace](https://pytorch.org/docs/stable/generated/torch.logspace.html#torch.logspace \"torch.logspace\")(0, [math.log](https://docs.python.org/3/library/math.html#math.log \"math.log\")(0.99 * [nyquist_freq](https://docs.python.org/3/library/functions.html#float \"builtins.float\"), 10), [NUM_FRAMES](https://docs.python.org/3/library/functions.html#int \"builtins.int\")).unsqueeze(-1)\n[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.ones](https://pytorch.org/docs/stable/generated/torch.ones.html#torch.ones \"torch.ones\")(([NUM_FRAMES](https://docs.python.org/3/library/functions.html#int \"builtins.int\"), 1))\n\n[waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = oscillator_bank([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), sample_rate=[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\"))\n\nshow([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\"), vol=0.2) \n```", "```py\n[fm](https://docs.python.org/3/library/functions.html#float \"builtins.float\") = 2.5  # rate at which the frequency oscillates\n[f_dev](https://docs.python.org/3/library/functions.html#float \"builtins.float\") = 0.9 * [F0](https://docs.python.org/3/library/functions.html#float \"builtins.float\")  # the degree of frequency oscillation\n\n[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [F0](https://docs.python.org/3/library/functions.html#float \"builtins.float\") + [f_dev](https://docs.python.org/3/library/functions.html#float \"builtins.float\") * [torch.sin](https://pytorch.org/docs/stable/generated/torch.sin.html#torch.sin \"torch.sin\")([torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(0, [fm](https://docs.python.org/3/library/functions.html#float \"builtins.float\") * [PI2](https://docs.python.org/3/library/functions.html#float \"builtins.float\") * [DURATION](https://docs.python.org/3/library/functions.html#float \"builtins.float\"), [NUM_FRAMES](https://docs.python.org/3/library/functions.html#int \"builtins.int\")))\n[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").unsqueeze(-1)\n\n[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.ones](https://pytorch.org/docs/stable/generated/torch.ones.html#torch.ones \"torch.ones\")(([NUM_FRAMES](https://docs.python.org/3/library/functions.html#int \"builtins.int\"), 1))\n\n[waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = oscillator_bank([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), sample_rate=[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\"))\n\nshow([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\")) \n```", "```py\n[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.full](https://pytorch.org/docs/stable/generated/torch.full.html#torch.full \"torch.full\")(([SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\"), 1), [F0](https://docs.python.org/3/library/functions.html#float \"builtins.float\"))\n[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = adsr_envelope(\n    [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\"),\n    attack=0.2,\n    hold=0.2,\n    decay=0.2,\n    sustain=0.5,\n    release=0.2,\n    n_decay=1,\n)\n[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").unsqueeze(-1)\n\n[waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = oscillator_bank([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), sample_rate=[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\"))\n\naudio = show([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\"))\nax = plt.gcf().axes[1]\nax.annotate(\"Attack\", xy=(0.05, 0.7))\nax.annotate(\"Hold\", xy=(0.28, 0.65))\nax.annotate(\"Decay\", xy=(0.45, 0.5))\nax.annotate(\"Sustain\", xy=(0.65, 0.3))\nax.annotate(\"Release\", xy=(0.88, 0.35))\naudio \n```", "```py\n[unit](https://docs.python.org/3/library/functions.html#int \"builtins.int\") = [NUM_FRAMES](https://docs.python.org/3/library/functions.html#int \"builtins.int\") // 3\n[repeat](https://docs.python.org/3/library/functions.html#int \"builtins.int\") = 9\n\n[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.empty](https://pytorch.org/docs/stable/generated/torch.empty.html#torch.empty \"torch.empty\")(([unit](https://docs.python.org/3/library/functions.html#int \"builtins.int\") * [repeat](https://docs.python.org/3/library/functions.html#int \"builtins.int\"), 2))\n[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")[:, 0] = [F0](https://docs.python.org/3/library/functions.html#float \"builtins.float\") / 9\n[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")[:, 1] = [F0](https://docs.python.org/3/library/functions.html#float \"builtins.float\") / 5\n\n[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.stack](https://pytorch.org/docs/stable/generated/torch.stack.html#torch.stack \"torch.stack\")(\n    (\n        adsr_envelope([unit](https://docs.python.org/3/library/functions.html#int \"builtins.int\"), attack=0.01, hold=0.125, decay=0.12, sustain=0.05, release=0),\n        adsr_envelope([unit](https://docs.python.org/3/library/functions.html#int \"builtins.int\"), attack=0.01, hold=0.25, decay=0.08, sustain=0, release=0),\n    ),\n    dim=-1,\n)\n[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").[repeat](https://docs.python.org/3/library/functions.html#int \"builtins.int\")([repeat](https://docs.python.org/3/library/functions.html#int \"builtins.int\"), 1) / 2\n\n[bass](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = oscillator_bank([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), sample_rate=[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\"))\n\nshow([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [bass](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\"), vol=0.5) \n```", "```py\n[tones](https://docs.python.org/3/library/stdtypes.html#list \"builtins.list\") = [\n    513.74,  # do\n    576.65,  # re\n    647.27,  # mi\n    685.76,  # fa\n    769.74,  # so\n    685.76,  # fa\n    647.27,  # mi\n    576.65,  # re\n    513.74,  # do\n]\n\n[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.cat](https://pytorch.org/docs/stable/generated/torch.cat.html#torch.cat \"torch.cat\")([[torch.full](https://pytorch.org/docs/stable/generated/torch.full.html#torch.full \"torch.full\")(([unit](https://docs.python.org/3/library/functions.html#int \"builtins.int\"), 1), tone) for tone in [tones](https://docs.python.org/3/library/stdtypes.html#list \"builtins.list\")], dim=0)\n[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = adsr_envelope([unit](https://docs.python.org/3/library/functions.html#int \"builtins.int\"), attack=0, decay=0.7, sustain=0.28, release=0.29)\n[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").[repeat](https://docs.python.org/3/library/functions.html#int \"builtins.int\")(9).unsqueeze(-1)\n\n[doremi](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = oscillator_bank([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), sample_rate=[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\"))\n\nshow([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [doremi](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\")) \n```", "```py\n[env](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = adsr_envelope([NUM_FRAMES](https://docs.python.org/3/library/functions.html#int \"builtins.int\") * 6, attack=0.98, decay=0.0, sustain=1, release=0.02)\n\n[tones](https://docs.python.org/3/library/stdtypes.html#list \"builtins.list\") = [\n    484.90,  # B4\n    513.74,  # C5\n    576.65,  # D5\n    1221.88,  # D#6/Eb6\n    3661.50,  # A#7/Bb7\n    6157.89,  # G8\n]\n[freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.stack](https://pytorch.org/docs/stable/generated/torch.stack.html#torch.stack \"torch.stack\")([f * [env](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") for f in [tones](https://docs.python.org/3/library/stdtypes.html#list \"builtins.list\")], dim=-1)\n\n[amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [env](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").unsqueeze(-1).expand([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").shape) / len([tones](https://docs.python.org/3/library/stdtypes.html#list \"builtins.list\"))\n\n[waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = oscillator_bank([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), sample_rate=[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\"))\n\nshow([freq](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [amp](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [waveform](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\")) \n```"]