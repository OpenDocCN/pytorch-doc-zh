# torch.random

> 原文：[https://pytorch.org/docs/stable/random.html](https://pytorch.org/docs/stable/random.html)

```py
torch.random.fork_rng(devices=None, enabled=True, _caller='fork_rng', _devices_kw='devices', device_type='cuda')¶
```

分叉RNG，以便在返回时，RNG被重置为先前的状态。

参数

+   **devices** (*可迭代的* *设备ID*) – 要分叉RNG的设备。CPU RNG状态始终被分叉。默认情况下，[`fork_rng()`](#torch.random.fork_rng "torch.random.fork_rng")在所有设备上操作，但如果您的机器有很多设备，此函数将运行非常缓慢，将发出警告。如果您明确指定设备，则此警告将被抑制

+   **enabled** ([*bool*](https://docs.python.org/3/library/functions.html#bool "(在Python v3.12中)")) – 如果为`False`，则不分叉RNG。这是一个方便的参数，可以轻松禁用上下文管理器，而无需删除它并将Python代码缩进在其下面。

+   **deivce_type** ([*str*](https://docs.python.org/3/library/stdtypes.html#str "(在Python v3.12中)")) – 设备类型str，默认为cuda。至于自定义设备，请参阅[注：支持带有privateuse1的自定义设备]

返回类型

[*生成器*](https://docs.python.org/3/library/typing.html#typing.Generator "(在Python v3.12中)")

```py
torch.random.get_rng_state()¶
```

将随机数生成器状态返回为torch.ByteTensor。

返回类型

[*张量*](tensors.html#torch.Tensor "torch.Tensor")

```py
torch.random.initial_seed()¶
```

返回生成随机数的初始种子作为Python长整型。

返回类型

[int](https://docs.python.org/3/library/functions.html#int "(在Python v3.12中)")

```py
torch.random.manual_seed(seed)¶
```

设置生成随机数的种子。返回一个torch.Generator对象。

参数

**seed** ([*int*](https://docs.python.org/3/library/functions.html#int "(在Python v3.12中)")) – 所需种子。值必须在包含范围[-0x8000_0000_0000_0000, 0xffff_ffff_ffff_ffff]内。否则，将引发RuntimeError。负输入将使用公式0xffff_ffff_ffff_ffff + seed重新映射为正值。

返回类型

[*生成器*](generated/torch.Generator.html#torch.Generator "torch._C.Generator")

```py
torch.random.seed()¶
```

将生成随机数的种子设置为非确定性随机数。返回用于种子RNG的64位数字。

返回类型

[int](https://docs.python.org/3/library/functions.html#int "(在Python v3.12中)")

```py
torch.random.set_rng_state(new_state)¶
```

设置随机数生成器状态。

参数

**new_state** (*torch.ByteTensor*) – 所需状态
