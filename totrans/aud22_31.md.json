["```py\nimport torch\nimport torchaudio\n\nprint(torch.__version__)\nprint([torchaudio.__version__](https://docs.python.org/3/library/stdtypes.html#str \"builtins.str\")) \n```", "```py\n2.2.0\n2.2.0 \n```", "```py\ntry:\n    from torchaudio.prototype.functional import filter_waveform, frequency_impulse_response, sinc_impulse_response\nexcept ModuleNotFoundError:\n    print(\n        \"Failed to import prototype DSP features. \"\n        \"Please install torchaudio nightly builds. \"\n        \"Please refer to https://pytorch.org/get-started/locally \"\n        \"for instructions to install a nightly build.\"\n    )\n    raise\n\nimport matplotlib.pyplot as plt\nfrom IPython.display import Audio \n```", "```py\n[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\") = 16_000\n[duration](https://docs.python.org/3/library/functions.html#int \"builtins.int\") = 4\n[num_frames](https://docs.python.org/3/library/functions.html#int \"builtins.int\") = int([duration](https://docs.python.org/3/library/functions.html#int \"builtins.int\") * [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\"))\n\n[noise](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.rand](https://pytorch.org/docs/stable/generated/torch.rand.html#torch.rand \"torch.rand\")(([num_frames](https://docs.python.org/3/library/functions.html#int \"builtins.int\"),)) - 0.5 \n```", "```py\ndef plot_input():\n    fig, axes = plt.subplots(2, 1, sharex=True)\n    t = [torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(0, [duration](https://docs.python.org/3/library/functions.html#int \"builtins.int\"), [num_frames](https://docs.python.org/3/library/functions.html#int \"builtins.int\"))\n    axes[0].plot(t, [noise](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"))\n    axes[0].grid(True)\n    axes[1].specgram([noise](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), Fs=[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\"))\n    Audio([noise](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), rate=[SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\"))\n\nplot_input() \n```", "```py\n[num_filters](https://docs.python.org/3/library/functions.html#int \"builtins.int\") = 64 * [duration](https://docs.python.org/3/library/functions.html#int \"builtins.int\")\n[window_size](https://docs.python.org/3/library/functions.html#int \"builtins.int\") = 2049\n\n[f_cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(0.0, 0.8, [num_filters](https://docs.python.org/3/library/functions.html#int \"builtins.int\"))\n[kernel](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = sinc_impulse_response([f_cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [window_size](https://docs.python.org/3/library/functions.html#int \"builtins.int\")) \n```", "```py\n[filtered](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = filter_waveform([noise](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [kernel](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")) \n```", "```py\ndef plot_sinc_ir(waveform, cutoff, sample_rate, vol=0.2):\n    [num_frames](https://docs.python.org/3/library/functions.html#int \"builtins.int\") = waveform.size(0)\n    [duration](https://docs.python.org/3/library/functions.html#int \"builtins.int\") = [num_frames](https://docs.python.org/3/library/functions.html#int \"builtins.int\") / sample_rate\n    num_cutoff = cutoff.size(0)\n    nyquist = sample_rate / 2\n\n    _, axes = plt.subplots(2, 1, sharex=True)\n    t = [torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(0, [duration](https://docs.python.org/3/library/functions.html#int \"builtins.int\"), [num_frames](https://docs.python.org/3/library/functions.html#int \"builtins.int\"))\n    axes[0].plot(t, waveform)\n    axes[0].grid(True)\n    axes[1].specgram(waveform, Fs=sample_rate, scale=\"dB\")\n    t = [torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(0, [duration](https://docs.python.org/3/library/functions.html#int \"builtins.int\"), num_cutoff)\n    axes[1].plot(t, cutoff * nyquist, color=\"gray\", linewidth=0.8, label=\"Cutoff Frequency\", linestyle=\"--\")\n    axes[1].legend(loc=\"upper center\")\n    axes[1].set_ylim([0, nyquist])\n    waveform /= waveform.abs().max()\n    return Audio(vol * waveform, rate=sample_rate, normalize=False) \n```", "```py\nplot_sinc_ir([filtered](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [f_cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\")) \n```", "```py\n[PI2](https://docs.python.org/3/library/functions.html#float \"builtins.float\") = [torch.pi](https://docs.python.org/3/library/functions.html#float \"builtins.float\") * 2\n[num_filters](https://docs.python.org/3/library/functions.html#int \"builtins.int\") = 90 * [duration](https://docs.python.org/3/library/functions.html#int \"builtins.int\")\n\n[f_lfo](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(0.9, 0.1, [num_filters](https://docs.python.org/3/library/functions.html#int \"builtins.int\"))\n[f_cutoff_osci](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(0.01, 0.03, [num_filters](https://docs.python.org/3/library/functions.html#int \"builtins.int\")) * [torch.sin](https://pytorch.org/docs/stable/generated/torch.sin.html#torch.sin \"torch.sin\")([torch.cumsum](https://pytorch.org/docs/stable/generated/torch.cumsum.html#torch.cumsum \"torch.cumsum\")([f_lfo](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), dim=0))\n[f_cutoff_base](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(0.8, 0.03, [num_filters](https://docs.python.org/3/library/functions.html#int \"builtins.int\")) ** 1.7\n[f_cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [f_cutoff_base](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") + [f_cutoff_osci](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") \n```", "```py\n[kernel](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = sinc_impulse_response([f_cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [window_size](https://docs.python.org/3/library/functions.html#int \"builtins.int\"))\n[filtered](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = filter_waveform([noise](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [kernel](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")) \n```", "```py\nplot_sinc_ir([filtered](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [f_cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\")) \n```", "```py\n[f_lfo](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(0.15, 0.15, [num_filters](https://docs.python.org/3/library/functions.html#int \"builtins.int\"))\n[f_cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = 0.07 + 0.06 * [torch.sin](https://pytorch.org/docs/stable/generated/torch.sin.html#torch.sin \"torch.sin\")([torch.cumsum](https://pytorch.org/docs/stable/generated/torch.cumsum.html#torch.cumsum \"torch.cumsum\")([f_lfo](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), dim=0)) \n```", "```py\n[kernel](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = sinc_impulse_response([f_cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [window_size](https://docs.python.org/3/library/functions.html#int \"builtins.int\"))\n[filtered](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = filter_waveform([noise](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [kernel](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")) \n```", "```py\nplot_sinc_ir([filtered](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [f_cutoff](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\")) \n```", "```py\n[magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.sin](https://pytorch.org/docs/stable/generated/torch.sin.html#torch.sin \"torch.sin\")([torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(0, 10, 64)) ** 4.0\n[kernel](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = frequency_impulse_response([magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"))\n[filtered](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = filter_waveform([noise](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [kernel](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").unsqueeze(0)) \n```", "```py\ndef plot_waveform([magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [filtered](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), sample_rate):\n    nyquist = sample_rate / 2\n    num_samples = [filtered](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").size(-1)\n    [duration](https://docs.python.org/3/library/functions.html#int \"builtins.int\") = num_samples / sample_rate\n\n    # Re-organize magnitudes for overlay\n    N = 10  # number of overlays\n    interval = [torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(0.05, 0.95, N)\n    offsets = [duration](https://docs.python.org/3/library/functions.html#int \"builtins.int\") * interval\n    # Select N magnitudes for overlays\n    mags = [torch.stack](https://pytorch.org/docs/stable/generated/torch.stack.html#torch.stack \"torch.stack\")(\n        [[magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") for _ in range(N)]\n        if [magnitudes.ndim](https://docs.python.org/3/library/functions.html#int \"builtins.int\") == 1\n        else [[magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")[int(i * [magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").size(0))] for i in interval]\n    )\n    mag_x = offsets.unsqueeze(-1) + 0.1 * mags\n    mag_y = [torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(0, nyquist, [magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").size(-1)).tile((N, 1))\n\n    _, ax = plt.subplots(1, 1, sharex=True)\n    ax.vlines(offsets, 0, nyquist, color=\"gray\", linestyle=\"--\", linewidth=0.8)\n    ax.plot(mag_x.T.numpy(), mag_y.T.numpy(), color=\"gray\", linewidth=0.8)\n    ax.specgram([filtered](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), Fs=sample_rate)\n    return Audio([filtered](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), rate=sample_rate) \n```", "```py\nplot_waveform([magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [filtered](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\")) \n```", "```py\n[magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.stack](https://pytorch.org/docs/stable/generated/torch.stack.html#torch.stack \"torch.stack\")([[torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(0.0, w, 1000) for w in [torch.linspace](https://pytorch.org/docs/stable/generated/torch.linspace.html#torch.linspace \"torch.linspace\")(4.0, 40.0, 250)])\n[magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.sin](https://pytorch.org/docs/stable/generated/torch.sin.html#torch.sin \"torch.sin\")([magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")) ** 4.0 \n```", "```py\n[kernel](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = frequency_impulse_response([magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"))\n[filtered](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = filter_waveform([noise](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [kernel](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\")) \n```", "```py\nplot_waveform([magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [filtered](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\")) \n```", "```py\n[magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = [torch.concat](https://pytorch.org/docs/stable/generated/torch.concat.html#torch.concat \"torch.concat\")([[torch.ones](https://pytorch.org/docs/stable/generated/torch.ones.html#torch.ones \"torch.ones\")((32,)), [torch.zeros](https://pytorch.org/docs/stable/generated/torch.zeros.html#torch.zeros \"torch.zeros\")((32,))]) \n```", "```py\n[kernel](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = frequency_impulse_response([magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"))\n[filtered](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\") = filter_waveform([noise](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [kernel](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\").unsqueeze(0)) \n```", "```py\nplot_waveform([magnitudes](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [filtered](https://pytorch.org/docs/stable/tensors.html#torch.Tensor \"torch.Tensor\"), [SAMPLE_RATE](https://docs.python.org/3/library/functions.html#int \"builtins.int\")) \n```"]